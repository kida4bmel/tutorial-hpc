Bootstrap: library
From: ubuntu:22.04

%environment
    export MYPORT=1234

%files
    requirements.txt /hpc-util/requirements.txt
    test.py /hpc-util/test.py

%post
    apt update && apt install -y python3 python3-pip
    pip install -r /hpc-util/requirements.txt
    echo 'export MYPORT=1235' >> $SINGULARITY_ENVIRONMENT

%startscript
    python3 -m http.server ${MYPORT}

%runscript
    python3 /hpc-util/test.py